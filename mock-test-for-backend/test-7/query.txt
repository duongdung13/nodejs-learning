const thirtyDaysAgo = new Date(Date.now() - 1000 * 60 * 60 * 24 * 30);

db.getCollection("reviews").aggregate([
{
    $match: {
      createdAt: {
        $gte: thirtyDaysAgo
      }
    }
},
{
    $group: {
        _id: "$hotelId",
        avgRating: {
            $avg: "$rating"
        },
        totalReviews: {
            $sum : 1
        }
    }
},
{
    $sort: {
        avgRating: -1
    }
},
{
    $limit: 10
}

]);